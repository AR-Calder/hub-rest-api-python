'''
Created on Nov 11, 2018

@author: gsnyder
'''
import argparse
from blackduck.HubRestApi import HubInstance
from pprint import pprint

hub = HubInstance()

parser = argparse.ArgumentParser()
parser.add_argument("vulnerability", help="A CVE or BDSA number, e.g. CVE-2016-4009")
args = parser.parse_args()

affected_projects = hub.get_vulnerability_affected_projects(args.vulnerability)
for project in affected_projects['items']:
	pprint(project)